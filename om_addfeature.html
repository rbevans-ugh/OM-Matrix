<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="dist/bootstrap/bootstrap.min.css">

    <title>Add Feature!</title>
  </head>
  <script type="text/javascript">
  function addFeature() {
    console.log("hi");
    var idText1 = document.getElementById("featureName").value;
    var idText2 = document.getElementById("o365").checked;
    var idText3 = document.getElementById("outlook").checked;
    var idText4 = document.getElementById("o365gcc").checked;
    var idText5 = document.getElementById("gmail").checked;
    var idText6 = document.getElementById("gmailcc").checked;
    var idText7 = document.getElementById("imap").checked;
    var idText8 = document.getElementById("imapcc").checked;
    var idText9 = document.getElementById("yahoo").checked;
    var idText10 = document.getElementById("yahoocc").checked;
    var idText11 = document.getElementById("icloud").checked;
    var idText12 = document.getElementById("icloudcc").checked;
    var idText13 = document.getElementById("opcc").checked;
    var idText14 = document.getElementById("pop3").checked;
    var data = { featureName: idText1, 
      o365: idText2, 
      outlook: idText3, 
      o365gcc: idText4, 
      gmail: idText5, 
      gmailcc: idText6, 
      imap: idText7, 
      imapcc: idText8, 
      yahoo: idText9, 
      yahoocc: idText10, 
      icloud: idText11, 
      icloudcc: idText12, 
      opcc: idText13, 
      pop3: idText14, };
    //url is hardcoded from flow. 
    console.log(data);
    var url =
      "https://prod-13.westcentralus.logic.azure.com:443/workflows/8842686e9b144eec824a6f70c22fb574/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=LAMZ92ClZ9IDMzGCUgRvmFwJtWB0tGvKBLkJmd7ZHjY";
    //clear old content out so we're not concating results on each run.
    fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(data)
    })
      .then(function(response) {
        return response.json();
      });
      console.log("got the response from Flow");
  }

  </script>
  <body>
    	  <!-- Nav Bar -->
	<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
			<a class="navbar-brand" href="index.html">One Outlook</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarNav">
				<ul class="navbar-nav">
				<li class="nav-item active">
					<a class="nav-link" href="index.html">Client Matrix<span class="sr-only">(current)</span></a>
				</li>
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Client
					</a>
					<div class="dropdown-menu" aria-labelledby="navbarDropdown">
					<a class="dropdown-item" href="om_matrix.html">Outlook Mobile</a>
					<a class="dropdown-item" href="mac_matrix.html">Outlook Mac</a>
					<a class="dropdown-item" href="#">Outlook Web</a>
					<a class="dropdown-item" href="#">Outlook Desktop</a>
					</div>	
				</li>
			</ul>
		</div>
	</nav>
		  <div class="jumbotron text-center">
          <div class="container">
            <img src="dist/om.png" alt="Hey yo" width=10%>
            <h1>Add & Update Feature</h1>
          </div>
          </div>
          <div class="container-fluid">
              <form>
                  <div class="form-group">
                    <label for="featureName">Feature Name:</label>
                    <input type="text" class="form-control" id="featureName" placeholder="Shared Mailbox" required>
                  </div>
                      <div class="form-check form-check-inline">
                          <input class="form-check-input" type="checkbox" id="o365" value="N">
                          <label class="form-check-label" for="o365">O365</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="checkbox" id="outlook" value="N">
                          <label class="form-check-label" for="outlook">Outlook</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="checkbox" id="o365gcc" value="N">
                          <label class="form-check-label" for="o365gcc">O365 GCC</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="checkbox" id="gmail" value="N">
                          <label class="form-check-label" for="gmail">Gmail</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="checkbox" id="gmailcc" value="N">
                          <label class="form-check-label" for="gmailcc">Gmail - CC</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="checkbox" id="imap" value="N">
                          <label class="form-check-label" for="imap">IMAP</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="checkbox" id="imapcc" value="N">
                          <label class="form-check-label" for="imapcc">IMAP - CC</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="checkbox" id="yahoo" value="N">
                          <label class="form-check-label" for="yahoo">Yahoo</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="checkbox" id="yahoocc" value="N">
                          <label class="form-check-label" for="yahoocc">Yahoo - CC</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="checkbox" id="icloud" value="N">
                          <label class="form-check-label" for="icloud">iCloud</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="checkbox" id="icloudcc" value="N">
                          <label class="form-check-label" for="icloudcc">iCloud - CC</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="checkbox" id="opcc" value="N">
                          <label class="form-check-label" for="opcc">U-OPCC</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="checkbox" id="pop3" value="N">
                          <label class="form-check-label" for="pop3">POP3</label>
                        </div>
                  <br>
                  <submit type="submit" class="btn btn-primary btn-lg btn-block btn-dark" onclick="addFeature()">Submit Feature</button>
                </form>
          </div>  
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  </body>
</html>